<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Payment History - Nexus ERP</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Sora:wght@600;700&family=Inter:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
        background-color: #111111;
        color: #a1a1aa;
      }
      .font-title {
        font-family: "Sora", sans-serif;
      }
    </style>
  </head>
  <body>
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <header class="mb-10 flex justify-between items-center">
        <div>
          <h1 class="text-3xl font-bold text-white font-title">
            Payment History
          </h1>
          <p class="text-gray-500 mt-1">
            A record of all your completed transactions.
          </p>
        </div>
        <a
          href="/dashboard"
          class="bg-gray-800/50 text-gray-300 font-semibold py-2 px-5 rounded-lg hover:bg-gray-700/50 transition-colors inline-flex items-center"
        >
          <i class="fas fa-arrow-left mr-2"></i>
          Return to Dashboard
        </a>
      </header>

      <!-- PAYMENT HISTORY TABLE -->
      <div
        class="bg-gray-900/50 border border-gray-800 rounded-lg overflow-hidden"
      >
        <table class="w-full text-left">
          <thead class="bg-gray-800/50">
            <tr>
              <th class="p-4 font-semibold text-white text-sm">Fee Title</th>
              <th class="p-4 font-semibold text-white text-sm">Amount</th>
              <th class="p-4 font-semibold text-white text-sm">Payment Date</th>
              <th class="p-4 font-semibold text-white text-sm">
                Transaction ID
              </th>
              <th class="p-4 font-semibold text-white text-sm text-center">
                Receipt
              </th>
            </tr>
          </thead>
          <tbody>
            <% if (payments.length === 0) { %>
            <tr>
              <td colspan="5" class="text-center py-20">
                <i class="fas fa-receipt text-5xl text-gray-600"></i>
                <h2 class="mt-4 text-xl font-bold text-white font-title">
                  No Payments Found
                </h2>
                <p class="text-gray-500">Your payment history is empty.</p>
              </td>
            </tr>
            <% } else { %> <% payments.forEach(payment => { %>
            <tr
              class="border-t border-gray-800 hover:bg-gray-800/50 transition-colors"
            >
              <td class="p-4 font-medium text-white">
                <%= payment.fees_announcement.title %>
              </td>
              <td class="p-4 text-gray-300">
                â‚¹<%= payment.amount.toLocaleString('en-IN') %>
              </td>
              <td class="p-4 text-gray-400">
                <%= new Date(payment.createdAt).toLocaleDateString('en-IN', {
                day: 'numeric', month: 'long', year: 'numeric' }) %>
              </td>
              <td class="p-4 text-gray-500 font-mono text-xs">
                <%= payment._id %>
              </td>
              <td class="p-4 text-center">
                <a
                  href="<%= payment.receipt_url %>"
                  target="_blank"
                  class="bg-emerald-500/10 text-emerald-400 font-bold py-2 px-4 rounded-md hover:bg-emerald-500/20 transition-colors text-sm inline-flex items-center"
                >
                  <i class="fas fa-download mr-2"></i>
                  Download
                </a>
              </td>
            </tr>
            <% }) %> <% } %>
          </tbody>
        </table>
      </div>
    </div>
  </body>
</html>
